name: Debug Sync Workflow
on:
  push:
    branches:
      - master
jobs:
  debug-sync:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@v3
        
      - name: Debug environment
        run: |
          echo "Repository: ${{ github.repository }}"
          echo "Actor: ${{ github.actor }}"
          echo "Has GH_TOKEN: ${{ secrets.GH_TOKEN != '' }}"
          git --version
          
      - name: Attempt PR creation
        uses: peter-evans/create-pull-request@v5
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          branch: debug-sync-branch
          base: master-jdk21
          title: 'Debug: Sync test PR'
          body: 'Testing PR creation from workflow'
          
      - name: Check if master-jdk21 exists
        run: |
          git fetch origin || echo "Fetch failed"
          git branch -r
          if git show-ref --quiet refs/remotes/origin/master-jdk21; then
            echo "master-jdk21 branch exists"
          else
            echo "master-jdk21 branch does NOT exist"
            echo "Creating master-jdk21 branch"
            git checkout -b master-jdk21
            git push origin master-jdk21
          fi